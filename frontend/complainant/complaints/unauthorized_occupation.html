<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" type="image/png" href="/images/logo.png">
  <title>ReklaMap</title>
  <link rel="stylesheet" href="/css/complainants.css">
</head>
<body>

  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="logo-section">
      <img src="/images/logo.png" alt="ReklaMap Logo" class="logo">
      <span class="title"><span class="blue-text">Rekla</span><span class="green-text">Map</span></span>
    </div>
    <nav class="nav-menu">
      <a href="/complainant/home/dashboard.html" class="nav-item">Home</a>
      <a href="/complainant/complaints/submitted_complaints.html" class="nav-item active">Complaints</a>
    </nav>
  </aside>
  

  <!-- Main Form -->
  <div class="main">
    <div class="form-container">
      <h1 style="text-decoration: underline;">COMPLAINT FORM <br> UNAUTHORIZED OCCUPATION</h1>
      <div class="instructions">
        <p><strong>INSTRUCTION</strong></p>
        <ul>
          <li>Complete the application form properly and legibly.</li>
          <li>For checkbox items (☑), you may select more than one option if applicable.</li>
          <li>For radio button items (◉), please select only one option.</li>
          <li>If a field or question does not apply to you or you do not know the answer, write “N/A” (Not Applicable).</li>
          <li>Ensure all required fields are filled before submitting the form.</li>
        </ul>
      </div>

      <div class="section-header">COMPLAINANT'S DETAILS:</div>
        <div class="pairs">
          <div class="pair-row">
            <div class="col">
              <label class="small">Full Name:</label>
              <input type="text" name="full_name" readonly>
            </div>
          </div>

          <div class="pair-row">
            <div class="col">
              <label class="small">Date of Birth:</label>
              <input type="date" name="date_of_birth" readonly 
              style="margin-top: 6px; margin-left: 13px; padding:7px;border:1px solid #cfdcea;border-radius:3px;font-size:13px;background:white; width: 96%;">
            </div>

            <div class="col">
              <label class="small">Sex:</label>
              <input type="text" name="sex" readonly>
            </div>
          </div>

          <div class="pair-row">
            <div class="col">
              <label class="small">Civil Status:</label>
              <input type="text" name="civil_stat" readonly>
            </div>
            <div class="col">
              <label class="small">Citizenship:</label>
              <input type="text" name="citizenship" readonly>
            </div>
          </div>

          <div class="pair-row">
            <div class="col">
              <label class="small">Current Address:</label>
              <input type="text" name="cur_add" readonly>
            </div>

            <div class="col">
              <label class="small">HOA:</label>
              <input type="text" name="hoa" readonly>
            </div>
          </div>

          <div class="pair-row">
            <div class="col">
              <label class="small">Block Assignment Number:</label>
              <input type="text" name="blk_num" readonly>
            </div>

            <div class="col">
              <label class="small">Lot Assignment Number:</label>
              <input type="text" name="lot_num" readonly>
            </div>

            <div class="col">
              <label class="small">Lot Area Size:</label>
              <input type="text" name="lot_size" readonly>
            </div>
          </div>

          <div class="pair-row">
            <div class="col">
              <label class="small">Phone Number:</label>
              <input type="text" name="phone_number" readonly>
            </div>

            <div class="col"></div>
          </div>
        </div>

      <!-- Section 1 -->
      <div class="section-header">LOT DETAILS AND CLAIM:</div>

      <p style="font-weight: bold;">1. What is your legal connection to this property?</p>
      <label><input type="radio" name="legal_connection" value="beneficiary"> I am an awarded beneficiary.</label>
      <label><input type="radio" name="legal_connection" value="representative"> I am an authorized representative of the owner/beneficiary.</label>
      <label><input type="radio" name="legal_connection" value="heir"> I am an heir/successor-in-interest of the deceased registered owner.</label>
      <label><input type="radio" name="legal_connection" value="purchaser"> I am the purchaser/buyer with a signed Deed of Sale or Contract to Sell.</label>
      <label><input type="radio" name="legal_connection" value="lessee"> I am a lessee/tenant with a valid and current lease agreement.</label>
      <label><input type="radio" name="legal_connection" value="hoa_officer"> I am a public Officer reporting on a common area</label>
      <label><input type="radio" name="legal_connection" value="representative" style="margin-bottom: 12px;"> I am an authorized representative representative of the owner/beneficiary</label>

      <p style="font-weight: bold;">2. Who is currently occupying the lot?</p>
      <div id="involvedPersonsContainer">
        <div class="person-input">
          <input type="text" class="involved_person_name" name="involved_person_name[]" placeholder="Enter name">
        </div>
      </div>
      <button type="button" class="btn add small" id="addPersonBtn" style="margin-left: 15px; margin-bottom: 12px;">+ Add another person</button>

      <p style="font-weight: bold;">3.  When did you first notice the unauthorized occupation?</p>
      <input style="width: 20%; padding: 8px;  margin-left: 15px; margin-bottom: 12px; border: 1px solid #ccc; border-radius: 4px; font-size: 14px;" type="date">

      <p style="font-weight: bold;">4. What activities are being done on the property? <i style="font-size: 14px; font-weight: normal; color: grey;">(Check all that apply)</i></p>
      <label><input type="checkbox" name="activities" value="living"> Living/residing on the lot</label>
      <label><input type="checkbox" name="activities" value="built_structure"> Built a structure (house, shack, etc.)</label>
      <label><input type="checkbox" name="activities" value="fenced"> Fenced or enclosed the area</label>
      <label><input type="checkbox" name="activities" value="storing"> Storing personal belongings</label>
      <label><input type="checkbox" name="activities" value="utilities"> Connected utilities (water, electricity)</label>          
      <label><input type="checkbox" style="margin-bottom: 12px;"> Renting it out to someone else</label>

      <p style="font-weight: bold;">5. Have they claimed legal rights over the lot?</p>
      <label><input type="radio" name="occupant_claim" value="docs" id="occupant_claim_docs"> Yes, they presented documents</label>
      <div id="reasonDetails" style="display: none; margin-left: 22px;">
        <p style="font-weight: bold; margin-left: 15px;">Which documents do they have? <i style="font-size: 14px; font-weight: normal; color: grey;">(Check all that apply)</i></p>
        <label><input type="checkbox" name="occupant_documents[]" value="title" style="margin-left: 33px;"> Title</label>
        <label><input type="checkbox" name="occupant_documents[]" value="contract_to_sell" style="margin-left: 33px;"> Contract to Sell</label>
        <label><input type="checkbox" name="occupant_documents[]" value="certificate_full_payment" style="margin-left: 33px;"> Certificate of Full Payment</label>
        <label><input type="checkbox" name="occupant_documents[]" value="certificate_of_award" style="margin-left: 33px;"> Certificate of Award</label>
        <label><input type="checkbox" name="occupant_documents[]" value="contract_agreement" style="margin-left: 33px;"> Contract/Agreement</label>
        <label><input type="checkbox" name="occupant_documents[]" value="deed_of_sale" style="margin-left: 33px;"> Deed of Sale</label>
      </div>
      <label><input type="radio" name="occupant_claim" value="verbal"> Yes, a verbal claim only (no documents).</label>
      <label><input type="radio" name="occupant_claim" value="none"> No, they haven't made any claim.</label>
      <label><input type="radio" name="occupant_claim" value="unknown"> I don't know / I haven't asked.</label>

      <p style="font-weight: bold;">6. Have you tried to resolve this directly with the occupant?</p>
      <label><input type="radio" name="approach" value="yes" id="approachYes"> Yes, I have spoken with them</label>
      <div id="approachYesDetails" style="display: none; margin-left: 22px;">
        <p style="font-weight: bold; margin-left: 15px;">What was their response?</p>
        <label><input type="radio" name="approachDetails" style="margin-left: 33px;"> They admitted they have no documents</label>
        <label><input type="radio" name="approachDetails" style="margin-left: 33px;"> They refused to leave the lot</label>
        <label><input type="radio" name="approachDetails" style="margin-left: 33px;"> They claim they are the real owner</label>
        <label><input type="radio" name="approachDetails" style="margin-left: 33px;"> They ignored me</label>
        <label><input type="radio" name="approachDetails" style="margin-left: 33px;"> They became hostile or aggressive</label>
      </div>

      <label><input type="radio" name="approach" value="no" id="approachNo"> No</label>
      <div id="approachNoDetails" style="display: none; margin-left: 22px;">
        <p style="font-weight: bold; margin-left: 15px;">Why not?</p>
        <label><input type="radio" name="approachNoDetails" style="margin-left: 33px;"> I was advised not to confront them</label>
        <label><input type="radio" name="approachNoDetails" style="margin-left: 33px;"> I do not know them personally</label>
        <label><input type="radio" name="approachNoDetails" style="margin-left: 33px;"> I am not currently living in the area</label>
      </div>

      <p style="font-weight: bold;">7. Have you reported this to any authority? <i style="font-size: 14px; font-weight: normal; color: grey;">(Check all that apply)</i></p>
      <label><input type="checkbox"> Yes, I reported it to the Barangay</label>
      <label><input type="checkbox"> Yes, I reported it to the HOA</label>
      <label><input type="checkbox"> Yes, I reported it to the NGC</label>
      <label><input type="checkbox" style="margin-bottom: 12px;" name="Not yet"> Not yet</label>

      <p style="font-weight: bold;">8. What was the result of that report?</p>
      <label><input type="radio" name="result"> The occupant was formally asked to leave</label>
      <label><input type="radio" name="result"> I was asked to provide more documents</label>
      <label><input type="radio" name="result"> Still under investigation</label>
      <label><input type="radio" name="result"> The issue is still pending or unresolved.</label>
      <label><input type="radio" name="result"> No action was taken by the authority.</label>
      <label><input type="radio" name="result" style="margin-bottom: 12px;"> I was told I have no valid claim</label>

      <p style="font-weight: bold;">9. Have you filed a complaint about this specific issue with our department before?</p>
      <label><input type="radio" name="previous_complaint" value="yes" id="prevComplaintYes"> Yes</label>
      <div id="prevComplaintDetails" style="display:none;" class="indented">
        <label style="font-weight: bold; margin-left: 35px;">Please provide the previous complaint reference number, if known:
            <input type="text" name="prev_complaint_ref" placeholder="If not known please input NA" style="margin-left: 33px; width: 92%;">
        </label>
      </div>
      <label><input type="radio" name="previous_complaint" value="no" style="margin-bottom: 12px;"> No, this is the first time I am reporting it to this department.</label>

      <!-- Section 2 -->
      <p style="font-weight: bold;">Please describe what happened briefly, including how you found out about the issue.</p>
      <textarea></textarea>

      <!-- Section 3 -->
      <div class="section-header">COMPLAINANT’S CONSENT AND DECLARATION</div>
      <div class="consent">
        By submitting this complaint form, I hereby consent to the collection and processing of my personal information as necessary to address the issues raised regarding the lot in question. I confirm that the information provided is accurate and complete to the best of my knowledge. I understand that any false or incomplete information may affect the handling of my complaint, and I acknowledge that my personal details will be processed in compliance with the Privacy Act and other applicable laws.
      </div>

      <div class="signature">
        <input type="file" id="signatureInput" accept="image/*" style="display:none;" />
        <button type="button" class="upload-btn" onclick="document.getElementById('signatureInput').click()">Upload Signature</button>
        <span id="signatureFileName" style="margin-left:10px;  font-style:italic;"></span>
      </div>
    </div>
  </div>


<script>
function toggleSection(radioId, detailsId) {
  const radio = document.getElementById(radioId);
  const details = document.getElementById(detailsId);

  if (!radio || !details) return;

  radio.addEventListener("change", function () {
    if (radio.checked) {
      details.style.display = "block";
    }
  });

  const siblings = document.querySelectorAll(`input[name="${radio.name}"]`);
  siblings.forEach(r => {
    r.addEventListener("change", function () {
      if (!radio.checked) {
        details.style.display = "none";

        const textInputs = details.querySelectorAll("input[type=text], input[type=date]");
        textInputs.forEach(input => input.value = "");
        const radios = details.querySelectorAll("input[type=radio]");
        radios.forEach(radio => radio.checked = false);
        const checkboxes = details.querySelectorAll('input[type="checkbox"]');
        checkboxes.forEach(cb => cb.checked = false);
      }
    });
  });
}

// For Q6 yes/no sections
toggleSection("approachYes", "approachYesDetails");
toggleSection("approachNo", "approachNoDetails");

// Q1: Show "Other (Please specify)" input only when "Other" is selected
function setupOtherInlineRadio(radioSelector, inputSelector) {
  const radio = document.querySelector(radioSelector);
  const input = document.querySelector(inputSelector);
  if (!radio || !input) return;

  const group = document.querySelectorAll(`input[name="${radio.name}"]`);

  function update() {
    if (radio.checked) {
      input.style.display = "inline-block";
      input.disabled = false;
      input.focus();
    } else {
      input.style.display = "none";
      input.disabled = true;
      input.value = "";
    }
  }

  group.forEach(r => r.addEventListener("change", update));
  update();
}
setupOtherInlineRadio("#legal_connection_other", "#legal_connection_other_text");

// Q2: Add/remove involved persons
(function setupInvolvedPersons() {
  const container = document.getElementById("involvedPersonsContainer");
  const addBtn = document.getElementById("addPersonBtn");
  if (!container || !addBtn) return;

  function createPersonRow(withRemove = true) {
    const row = document.createElement("div");
    row.className = "person-input";
    row.style.display = "flex";
    row.style.gap = "8px";
    row.style.alignItems = "center";

    const input = document.createElement("input");
    input.type = "text";
    input.className = "involved_person_name";
    input.name = "involved_person_name[]";
    input.placeholder = "Enter name";
    input.style.width = "84%";

    row.appendChild(input);

    if (withRemove) {
      const removeBtn = document.createElement("button");
      removeBtn.type = "button";
      // make remove look same as add
      removeBtn.className = "btn add small remove-person";
      removeBtn.textContent = "Remove";
      row.appendChild(removeBtn);
    }

    return row;
  }

  // Ensure only rows after the first have remove buttons
  function normalizeRows() {
    const rows = container.querySelectorAll(".person-input");
    rows.forEach((row, idx) => {
      const removeBtn = row.querySelector(".remove-person");
      if (idx === 0 && removeBtn) {
        removeBtn.remove();
      } else if (idx > 0 && !removeBtn) {
        const btn = document.createElement("button");
        btn.type = "button";
        // make remove look same as add
        btn.className = "btn add small remove-person";
        btn.textContent = "Remove";
        row.appendChild(btn);
      }
    });
  }

  addBtn.addEventListener("click", () => {
    container.appendChild(createPersonRow(true));
    normalizeRows();
  });

  container.addEventListener("click", (e) => {
    if (e.target && e.target.classList.contains("remove-person")) {
      const row = e.target.closest(".person-input");
      if (row) row.remove();
      normalizeRows();
    }
  });

  // Normalize initial state
  normalizeRows();
})();

// Q5: Show document checklist only when "Yes, they presented documents" is selected
function toggleDetailsByRadioValue(groupName, targetValue, detailsId) {
  const radios = document.querySelectorAll(`input[name="${groupName}"]`);
  const details = document.getElementById(detailsId);
  if (!radios.length || !details) return;

  function clearFields() {
    details.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
    details.querySelectorAll('input[type="text"], input[type="date"], input[type="number"], textarea').forEach(el => el.value = "");
    details.querySelectorAll('input[type="radio"]').forEach(r => r.checked = false);
  }

  function update() {
    const selected = Array.from(radios).find(r => r.checked)?.value;
    if (selected === targetValue) {
      details.style.display = "block";
    } else {
      details.style.display = "none";
      clearFields();
    }
  }

  radios.forEach(r => r.addEventListener("change", update));
  update();
}
toggleDetailsByRadioValue("occupant_claim", "docs", "reasonDetails");
// fix No. 9: show previous complaint reference only when "Yes" is selected
toggleDetailsByRadioValue("previous_complaint", "yes", "prevComplaintDetails");

// Q7: Make "Not yet" exclusive - if checked, uncheck others and vice versa
(function setupExclusiveCheckbox() {
  const checkboxes = document.querySelectorAll('.main input[type="checkbox"]');
  const reportCheckboxes = [];
  
  // Find the authority reporting checkboxes (Q7)
  checkboxes.forEach(cb => {
    const label = cb.closest('label');
    if (label && (
      label.textContent.includes('reported it to the Barangay') ||
      label.textContent.includes('reported it to the HOA') ||
      label.textContent.includes('reported it to the NGC') ||
      label.textContent.includes('Not yet')
    )) {
      reportCheckboxes.push(cb);
    }
  });

  if (reportCheckboxes.length === 0) return;

  const notYetCheckbox = reportCheckboxes.find(cb => 
    cb.closest('label').textContent.includes('Not yet')
  );
  const otherCheckboxes = reportCheckboxes.filter(cb => cb !== notYetCheckbox);

  if (!notYetCheckbox) return;

  // When "Not yet" is checked, uncheck all others
  notYetCheckbox.addEventListener('change', function() {
    if (this.checked) {
      otherCheckboxes.forEach(cb => cb.checked = false);
    }
  });

  // When any other checkbox is checked, uncheck "Not yet"
  otherCheckboxes.forEach(cb => {
    cb.addEventListener('change', function() {
      if (this.checked) {
        notYetCheckbox.checked = false;
      }
    });
  });
})();
</script>

</body>
</html>