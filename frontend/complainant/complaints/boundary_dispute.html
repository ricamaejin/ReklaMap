<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" type="image/png" href="/images/logo.png">
  <title>ReklaMap</title>
  <link rel="stylesheet" href="/css/complainants.css">
</head>
<body>

  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="logo-section">
      <img src="/images/logo.png" alt="ReklaMap Logo" class="logo">
      <span class="title"><span class="blue-text">Rekla</span><span class="green-text">Map</span></span>
    </div>
    <nav class="nav-menu">
      <a href="/complainant/home/dashboard.html" class="nav-item">Home</a>
      <a href="/complainant/complaints/submitted_complaints.html" class="nav-item active">Complaints</a>
    </nav>
  </aside>
  

  <!-- Main Form -->
  <div class="main">
    <div class="form-container">
      <form  id="BoundaryDisputeForm">
      <h1 style="text-decoration: underline;">COMPLAINT FORM <br> BOUNDARY DISPUTE</h1>
      <div class="instructions">
        <p><strong>INSTRUCTION</strong></p>
        <ul>
          <li>Complete the application form properly and legibly.</li>
          <li>For checkbox items (☑), you may select more than one option if applicable.</li>
          <li>For radio button items (◉), please select only one option.</li>
          <li>If a field or question does not apply to you or you do not know the answer, write “N/A” (Not Applicable).</li>
          <li>Ensure all required fields are filled before submitting the form.</li>
        </ul>
      </div>

      <div class="section-header">COMPLAINANT'S DETAILS:</div>
        <div class="pairs">
          <div class="pair-row">
            <div class="col">
              <label class="small">Full Name:</label>
              <input type="text" name="full_name" readonly>
            </div>
          </div>

          <div class="pair-row">
            <div class="col">
              <label class="small">Date of Birth:</label>
              <input type="date" name="date_of_birth" readonly 
              style="margin-top: 6px; margin-left: 13px; padding:7px;border:1px solid #cfdcea;border-radius:3px;font-size:13px;background:white; width: 96%;">
            </div>

            <div class="col">
              <label class="small">Sex:</label>
              <input type="text" name="sex" readonly>
            </div>
          </div>

          <div class="pair-row">
            <div class="col">
              <label class="small">Civil Status:</label>
              <input type="text" name="civil_stat" readonly>
            </div>
            <div class="col">
              <label class="small">Citizenship:</label>
              <input type="text" name="citizenship" readonly>
            </div>
          </div>

          <div class="pair-row">
            <div class="col">
              <label class="small">Current Address:</label>
              <input type="text" name="cur_add" readonly>
            </div>

            <div class="col">
              <label class="small">HOA:</label>
              <input type="text" name="hoa" readonly>
            </div>
          </div>

          <div class="pair-row">
            <div class="col">
              <label class="small">Block Assignment Number:</label>
              <input type="text" name="blk_num" readonly>
            </div>

            <div class="col">
              <label class="small">Lot Assignment Number:</label>
              <input type="text" name="lot_num" readonly>
            </div>

            <div class="col">
              <label class="small">Lot Area Size:</label>
              <input type="text" name="lot_size" readonly>
            </div>
          </div>

          <div class="pair-row">
            <div class="col">
              <label class="small">Phone Number:</label>
              <input type="text" name="phone_number" readonly>
            </div>

            <div class="col"></div>
          </div>
        </div>

      <!-- Section 1 -->
      <div class="section-header">LOT DETAILS AND CLAIM:</div>
      <p><strong>1. What is the nature of the boundary issue? </strong> <i style="font-size: 14px; font-weight: normal; color: grey;">(Check all that apply)</i></p>
      <label><input type="checkbox" value="Neighbor structure extends beyond line"> A neighbor’s house or structure extends beyond their boundary line</label>
      <label><input type="checkbox" value="Fence overlaps into my property"> A fence or wall installed by the neighbor overlaps into my property</label>
      <label><input type="checkbox" value="Construction within my claimed boundary"> Construction is ongoing within my claimed boundary</label>
      <label><input type="checkbox" value="Shared boundary demolished"> Shared boundary structure (wall/fence) was demolished without consent</label>
      <label><input type="checkbox" value="Boundary markers moved"> Boundary markers (mohon) were moved or removed</label>
      <label><input type="checkbox" value="Neighbor expanded structure beyond assigned area"> The neighbor expanded their structure beyond their assigned area</label>
      <label><input type="checkbox" style="margin-bottom: 12px;"> Encroachment is affecting access to utilities (e.g., water, drainage, electricity)</label>


      <p><strong>2. How long has this encroachment existed?</strong></p>
      <label><input type="radio" name="conflict"> Less than 1 month</label>
      <label><input type="radio" name="conflict"> 1-6 months</label>
      <label><input type="radio" name="conflict"> More than 6 months</label>
      <label><input type="radio" name="conflict" style="margin-bottom: 12px;"> Not sure</label>

      <p><strong>3. Has the encroaching structure already been built or is it under construction?</strong></p>
      <label><input type="radio"> Fully constructed</label>
      <label><input type="radio"> Partially constructed</label>
      <label><input type="radio"> Ongoing construction</label>
      <label><input type="radio" style="margin-bottom: 12px;"> Structure was removed but boundary still contested</label>
      
      <p><strong>4. Were you given any prior notice before the structure crossed into your property?</strong></p>
      <label><input type="radio" name="notice"> Yes</label>
      <label><input type="radio" name="notice" style="margin-bottom: 12px;"> No</label>
      
      <p> <strong>5. Have you discussed or confronted the other party about the boundary issue?</strong></p>
      <label><input type="radio" name="confronted" value="yes" id="reasonYes"> Yes</label>
      <div id="reasonDetails" style="display: none; margin-left: 22px;">
        <p>Date Reported</p>
        <input id="reasonDateInput" type="date" style="width: 20%; padding: 8px; margin-top: 6px; margin-left: 18px; margin-bottom: 12px; border: 1px solid #ccc; border-radius: 4px; font-size: 14px;"/>
      </div>
      <label><input type="radio" name="confronted" value="no"> No</label>

      <p><strong>6. Has the dispute led to any of the following? </strong><i style="font-size: 14px; font-weight: normal; color: grey;">(Check all that apply)</i></p>
      <label><input type="checkbox"> Threats or harassment</label>
      <label><input type="checkbox"> Physical altercation</label>
      <label><input type="checkbox"> Demolition or forced entry</label>
      <label><input type="checkbox"> Property damage</label>
      <label><input type="checkbox" style="margin-bottom: 12px;" value="None"> None</label>

      <label><strong>7. Have you reported this boundary issue to any office or authority?</strong> <i style="font-size: 14px; font-weight: normal; color: grey;">(Check all that apply)</i></label>
      <label><input type="checkbox" name="boundary_reported_to[]" value="Barangay"> Barangay</label>
      <label><input type="checkbox" name="boundary_reported_to[]" value="HOA"> HOA</label>
      <label><input type="checkbox" name="boundary_reported_to[]" value="NGC"> NGC</label>
      <label><input type="checkbox" name="boundary_reported_to[]" value="NGC"> USAD - PHASELAD</label>
      <label><input type="checkbox" name="boundary_reported_to[]" value="none"> None</label>

      <label><strong>8. Was there any site inspection or verification conducted?</strong></label>
      <label><input type="radio" name="site_inspection" value="Yes - Barangay" required> Yes – by Barangay</label>
      <label><input type="radio" name="site_inspection" value="Yes - HOA"> Yes – by HOA</label>
      <label><input type="radio" name="site_inspection" value="Yes - NGC"> Yes – by NGC</label>
      <label><input type="radio" name="site_inspection" value="Yes - NGC"> Yes – by USAD - PHASELAD</label>
      <label><input type="radio" name="site_inspection" value="No"> No</label>
      <label><input type="radio" name="site_inspection" value="Not sure"> Not sure</label>

      <label><strong>9. What was the result of the report or inspection?</strong> <i style="font-size: 14px; font-weight: normal; color: grey;">(Check all that apply)</i></label>
      <label><input type="checkbox" name="site_result[]" value="Advised to adjust or vacate"> The other party was advised to adjust or vacate</label>
      <label><input type="checkbox" name="site_result[]" value="Asked to provide more documents"> I was advised to provide more documents</label>
      <label><input type="checkbox" name="site_result[]" value="Still under investigation"> The issue is still under investigation</label>
      <label><input type="checkbox" name="site_result[]" value="No valid claim"> I was told I have no valid claim</label>
      <label><input type="checkbox" name="site_result[]" value="No action taken"> No action was taken</label>
      <label><input type="checkbox" name="site_result[]" value="Not applicable"> Not applicable / No inspection yet</label>

      <label><strong>10. Do you have any documents or proof showing your boundary or property line?</strong></label>
      <label><input type="radio" name="have_docs" value="Yes" required> Yes</label>
        <div id="boundaryDocOptions" style="display:none; margin-left: 15px;">
          <p><strong>Please specify:</strong> <i style="font-size: 14px; font-weight: normal; color: grey;">(Check all that apply)</i></p>
          <label><input type="checkbox" name="boundary_docs[]" value="Subdivision or site survey map"> Subdivision or site survey map</label>
          <label><input type="checkbox" name="boundary_docs[]" value="Certificate of Lot Award (CLA)"> Title</label>
          <label><input type="checkbox" name="boundary_docs[]" value="Approved fence or building plan"> Building permit</label>
          <label><input type="checkbox" name="boundary_docs[]" value="Barangay certification or inspection report"> Barangay certification or inspection report</label>
          <label><input type="checkbox" name="boundary_docs[]" value="Photographs showing boundary markers or encroachment"> Photographs showing boundary markers or encroachment</label>
        </div>
      <label><input type="radio" name="have_docs" value="No"> No</label>

      <p><strong>11. Is there an ongoing development or government housing project in the area?</strong></p>
      <label><input type="radio" name="reason"> Yes</label>
      <label><input type="radio" name="reason"> No</label>
      <label><input type="radio" name="reason" style="margin-bottom: 12px;"> Not sure</label>

      <!-- Section 2 -->
      <div class="section-header">PERSONS INVOLVED DETAILS</div>
      <p>1. Who are the persons and specific block and lot numbers involved in the boundary dispute? 
        <i style="font-size: 14px; font-weight: normal; color: grey;">(Excluding yours)</i>
      </p>

      <div class="pairs" id="pairsContainer" aria-live="polite" style="background-color: #f8fbff; border-radius: 6px; padding: 12px;">
        <div class="pair-row" style="display: flex; gap: 12px; align-items: center; margin-bottom: 10px;">
          <div style="flex: 1;">
            <label for="personName">Name of Person</label>
            <input type="text" placeholder="Enter name" class="form-control" />
          </div>
          <div style="width: 140px;">
            <label for="blockNo">Block No.</label>
            <input type="text" placeholder="Block No." class="form-control" />
          </div>
          <div style="width: 140px;">
            <label for="lotNo">Lot No.</label>
            <input type="text" placeholder="Lot No." class="form-control" />
          </div>
          <button type="button" class="btn remove small" style="margin-top: 24px; color: #999;">Remove</button>
        </div>
      </div>

      <div class="pair-controls" style="margin-top: 10px;">
        <button type="button" class="btn add small" id="addPairBtn" style="margin-bottom: 8px;">+ Add</button>
        <span style="color: var(--muted); font-size: 13px; margin-left: 8px;">
          <i style="font-size: 14px; font-weight: normal; color: grey;">
            (If more than one person or area is affected, list all applicable entries.)
          </i>
        </span>
      </div>

      <label><strong>2. Relationship with the person involved:</strong></label>
      <div id="relationshipContainer">
        <div class="relationship-input" style="display: flex; gap: 8px; align-items: center; margin-bottom: 8px;">
          <input type="text" name="boundary_relationship" placeholder="Specify relationship (neighbor, relative, etc.)" style="flex: 1; margin-left: 15px;">
        </div>
      </div>
      <button type="button" class="btn add small" id="addRelationshipBtn" style="margin-left: 15px; margin-bottom: 12px;">+ Add another relationship</button>

      <label><strong>3. Do they reside on or near the disputed boundary?</strong></label>
      <div class="options-group">
        <label><input type="radio" name="boundary_reside" value="Yes"> Yes</label>
        <label><input type="radio" name="boundary_reside" value="No"> No</label>
        <label><input type="radio" name="boundary_reside" value="Not sure"> Not sure</label>
      </div>

      <label><strong>4. Do they claim to have legal or assignment documents?</strong></label>
      <div class="options-group">
        <label><input type="radio" name="boundary_claim_docs" value="Yes" id="boundaryClaimDocsYes"> Yes</label>
        <div id="boundaryClaimDocOptions" style="display:none; margin-left: 15px;">
          <p style="font-weight: bold; margin-left: 15px;">Which documents do they have? <i style="font-size: 14px; font-weight: normal; color: grey;">(Check all that apply)</i></p>
          <label><input type="checkbox" name="occupant_documents[]" value="title" style="margin-left: 33px;"> Title</label>
          <label><input type="checkbox" name="occupant_documents[]" value="contract_to_sell" style="margin-left: 33px;"> Contract to Sell</label>
          <label><input type="checkbox" name="occupant_documents[]" value="certificate_full_payment" style="margin-left: 33px;"> Certificate of Full Payment</label>
          <label><input type="checkbox" name="occupant_documents[]" value="qualification_stub" style="margin-left: 33px;"> Pre-qualification Stub</label>
          <label><input type="checkbox" name="occupant_documents[]" value="contract_agreement" style="margin-left: 33px;"> Contract/Agreement</label>
          <label><input type="checkbox" name="occupant_documents[]" value="deed_of_sale" style="margin-left: 33px;"> Deed of Sale</label>
        </div>
        <label><input type="radio" name="boundary_claim_docs" value="No"> No</label>
        <label><input type="radio" name="boundary_claim_docs" value="Not sure"> Not sure</label>
      </div>

      <!-- Section 3 -->
        <p  class="section-label">Please describe what happened briefly, including how you found out about the issue.</p>
        <textarea></textarea>

        <div class="section-header">COMPLAINANT’S CONSENT AND DECLARATION</div>
        <div class="consent">
          By submitting this complaint form, I hereby consent to the collection and processing of my personal information as necessary to address the issues raised regarding the lot in question. I confirm that the information provided is accurate and complete to the best of my knowledge. I understand that any false or incomplete information may affect the handling of my complaint, and I acknowledge that my personal details will be processed in compliance with the Privacy Act and other applicable laws.
        </div>

      <div class="signature">
        <input type="file" id="signatureInput" accept="image/*" style="display:none;" />
        <button type="button" class="upload-btn" onclick="document.getElementById('signatureInput').click()">Upload Signature</button>
        <span id="signatureFileName" style="margin-left:10px;  font-style:italic;"></span>
      </div>
      </form>
    </div>
  </div>


<script>
  function setupConditionalDisplay(radioYesId, containerId, groupName) {
    const yesRadio = document.getElementById(radioYesId);
    const container = document.getElementById(containerId);
    const radios = document.querySelectorAll(`input[name="${groupName}"]`);

    radios.forEach(radio => {
      radio.addEventListener("change", function () {
        if (yesRadio.checked) {
          container.style.display = "block";
        } else {
          container.style.display = "none";
          const input = container.querySelector("input");
          if (input) input.value = "";
        }
      });
    });
  } 

    // Apply to all "Other & Conditional" groups
    setupConditionalDisplay("reasonYes", "reasonDetails", "reason");


    function handleFileInputChange(inputId, fileNameDisplayId) {
    const sigInput = document.getElementById(inputId);
    const sigFileName = document.getElementById(fileNameDisplayId);

    sigInput.addEventListener("change", function () {
      if (this.files.length > 0) {
        sigFileName.textContent = "✔ " + this.files[0].name;
      } else {
        sigFileName.textContent = "";
      }
    });
  }
</script>

<script>
  /* Helper to show the error popup (keeps your existing style) */
  function showErrorPop(msg) {
    const pop = document.getElementById('errorPop');
    const popMsg = document.getElementById('errorPopMsg');
    if (!pop || !popMsg) return alert(msg);
    popMsg.textContent = msg;
    pop.style.display = 'block';
    pop.style.opacity = '1';
    setTimeout(() => {
      pop.style.opacity = '0';
      setTimeout(() => { pop.style.display = 'none'; }, 400);
    }, 1500);
  }

  document.addEventListener('DOMContentLoaded', () => {
    const form = document.getElementById('BoundaryDisputeForm');

    // Signature input logic
    const sigInput = document.getElementById('signatureInput');
    const submitBtn = document.getElementById('submitBtn');
    const sigName = document.getElementById('signatureFileName');

    if (sigInput) {
      sigInput.addEventListener('change', function() {
        if (this.files && this.files[0]) {
          if (sigName) sigName.textContent = this.files[0].name;
          if (submitBtn) submitBtn.style.display = 'inline-block';
        } else {
          if (sigName) sigName.textContent = '';
          if (submitBtn) submitBtn.style.display = 'none';
        }
      });
    }

    // Document section toggle
    const haveDocsRadios = form.querySelectorAll("input[name='have_docs']");
    const boundaryDocOptions = document.getElementById('boundaryDocOptions');
    haveDocsRadios.forEach(r =>
      r.addEventListener('change', () => {
        boundaryDocOptions.style.display = r.value === 'Yes' && r.checked ? 'block' : 'none';
      })
    );

    // Add block–lot pairs
  document.getElementById("addPairBtn").addEventListener("click", () => {
    const container = document.getElementById("pairsContainer");
    const row = document.createElement("div");
    row.classList.add("pair-row");
    row.style.display = "flex";
    row.style.gap = "12px";
    row.style.alignItems = "center";
    row.style.marginBottom = "10px";

    row.innerHTML = `
      <div style="flex: 1;">
        <input type="text" placeholder="Enter name" class="form-control" />
      </div>
      <div style="width: 140px;">
        <input type="text" placeholder="Block No." class="form-control" />
      </div>
      <div style="width: 140px;">
        <input type="text" placeholder="Lot No." class="form-control" />
      </div>
      <button type="button" class="btn remove small" style="color: #999;">Remove</button>
    `;

    row.querySelector(".remove").addEventListener("click", () => row.remove());
    container.appendChild(row);
  });


    // Submit handler
    form.addEventListener('submit', async e => {
      e.preventDefault();
      const fd = new FormData(form);
      // add array handling if needed

      try {
        const res = await fetch('/complainant/boundary_dispute/submit_boundary_dispute', {
          method: 'POST',
          body: fd,
          credentials: 'include'
        });
        const data = await res.json();
        if (data.success) {
          window.location.href = '/complainant/home/dashboard.html';
        } else {
          alert(data.message || 'Submission failed');
        }
      } catch (err) {
        alert('An error occurred while submitting.');
      }
    });

    // Q8: Make "None" exclusive - if checked, uncheck others and vice versa
    (function setupExclusiveCheckboxForBoundary() {
      const reportCheckboxes = form.querySelectorAll('input[name="boundary_reported_to[]"]');
      
      if (reportCheckboxes.length === 0) return;

      const noneCheckbox = Array.from(reportCheckboxes).find(cb => cb.value === 'None');
      const otherCheckboxes = Array.from(reportCheckboxes).filter(cb => cb !== noneCheckbox);

      if (!noneCheckbox) return;

      // When "None" is checked, uncheck all others
      noneCheckbox.addEventListener('change', function() {
        if (this.checked) {
          otherCheckboxes.forEach(cb => cb.checked = false);
        }
      });

      // When any other checkbox is checked, uncheck "None"
      otherCheckboxes.forEach(cb => {
        cb.addEventListener('change', function() {
          if (this.checked) {
            noneCheckbox.checked = false;
          }
        });
      });
    })();

    // Setup add/remove for "Relationship with the person involved" section
    (function setupRelationshipInputs() {
      const container = document.getElementById('relationshipContainer');
      const addBtn = document.getElementById('addRelationshipBtn');
      if (!container || !addBtn) return;

      function createRelationshipRow(withRemove = true) {
        const row = document.createElement('div');
        row.className = 'relationship-input';
        row.style.display = 'flex';
        row.style.gap = '8px';
        row.style.alignItems = 'center';
        row.style.marginBottom = '8px';

        const input = document.createElement('input');
        input.type = 'text';
        input.name = 'boundary_relationship[]';
        input.placeholder = 'Specify relationship (neighbor, relative, etc.)';
        input.style.flex = '1';
        input.style.marginLeft = '15px';

        row.appendChild(input);

        if (withRemove) {
          const removeBtn = document.createElement('button');
          removeBtn.type = 'button';
          removeBtn.className = 'btn add small remove-relationship';
          removeBtn.textContent = 'Remove';
          row.appendChild(removeBtn);
        }

        return row;
      }

      // Ensure only rows after the first have remove buttons
      function normalizeRows() {
        const rows = container.querySelectorAll('.relationship-input');
        rows.forEach((row, idx) => {
          const removeBtn = row.querySelector('.remove-relationship');
          if (idx === 0 && removeBtn) {
            removeBtn.remove();
          } else if (idx > 0 && !removeBtn) {
            const btn = document.createElement('button');
            btn.type = 'button';
            btn.className = 'btn add small remove-relationship';
            btn.textContent = 'Remove';
            row.appendChild(btn);
          }
        });
      }

      addBtn.addEventListener('click', () => {
        container.appendChild(createRelationshipRow(true));
        normalizeRows();
      });

      container.addEventListener('click', (e) => {
        if (e.target && e.target.classList.contains('remove-relationship')) {
          const row = e.target.closest('.relationship-input');
          if (row) row.remove();
          normalizeRows();
        }
      });

      // Normalize initial state
      normalizeRows();
    })();
  });
</script>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const form = document.getElementById('BoundaryDisputeForm');
  if (!form) return;

  // --- helpers ---
  function findQ6Start() {
    const nodes = Array.from(form.querySelectorAll('p, label, div, h1, h2, h3'));
    return nodes.find(el => {
      const t = (el.textContent || '').trim();
      return /^6\./.test(t) || /Has the dispute led/i.test(t);
    }) || null;
  }

  function isQ7Header(el) {
    if (!el) return false;
    const t = (el.textContent || '').trim();
    if (/^7\./.test(t)) return true;
    if (/Have you reported/i.test(t)) return true;
    const strong = el.querySelector && el.querySelector('strong');
    if (strong && /^\s*7\./.test((strong.textContent || '').trim())) return true;
    return false;
  }

  function collectCheckboxesBetween(startEl, stopCond) {
    const boxes = [];
    let el = startEl.nextElementSibling;
    while (el) {
      if (stopCond(el)) break;
      if (el.querySelector) {
        const inputs = Array.from(el.querySelectorAll('input[type="checkbox"]'));
        inputs.forEach(i => boxes.push(i));
      }
      el = el.nextElementSibling;
    }
    return boxes;
  }

  function setupExclusiveNoneForList(checkboxList) {
    if (!checkboxList || checkboxList.length === 0) return;
    // find the group's "None" checkbox by value or by label text
    const none = checkboxList.find(cb => {
      if (!cb) return false;
      const v = (cb.value || '').trim().toLowerCase();
      if (v === 'none') return true;
      const lbl = cb.closest && cb.closest('label');
      return lbl && /\bnone\b/i.test(lbl.textContent || '');
    });
    if (!none) return;
    const others = checkboxList.filter(cb => cb !== none);

    // initialize state (handles prechecked)
    if (none.checked) {
      others.forEach(cb => { cb.checked = false; cb.disabled = true; cb.closest('label')?.classList.add('disabled'); });
    } else {
      others.forEach(cb => { cb.disabled = false; cb.closest('label')?.classList.remove('disabled'); });
    }

    // When None toggles
    none.addEventListener('change', () => {
      if (none.checked) {
        others.forEach(cb => { cb.checked = false; cb.disabled = true; cb.closest('label')?.classList.add('disabled'); });
      } else {
        others.forEach(cb => { cb.disabled = false; cb.closest('label')?.classList.remove('disabled'); });
      }
    });

    // When any other is checked, ensure None is unchecked (and enabled)
    others.forEach(cb => {
      cb.addEventListener('change', () => {
        if (cb.checked) {
          none.checked = false;
          none.disabled = false;
          none.closest('label')?.classList.remove('disabled');
        }
      });
    });
  }

  // --- Q6: collect checkboxes between Q6 header and Q7 header ---
  const q6Start = findQ6Start();
  const q6Checkboxes = q6Start ? collectCheckboxesBetween(q6Start, isQ7Header) : [];
  setupExclusiveNoneForList(q6Checkboxes);

  // --- Q7: by name attribute ---
  const q7Checkboxes = Array.from(form.querySelectorAll('input[name="boundary_reported_to[]"][type="checkbox"]'));
  setupExclusiveNoneForList(q7Checkboxes);

  // --- small CSS hint for disabled labels (visual cue) ---
  const style = document.createElement('style');
  style.textContent = `
    label.disabled { opacity: 0.6; }
    label.disabled input { cursor: not-allowed; }
  `;
  document.head.appendChild(style);
});
</script>

<script>
  document.addEventListener("DOMContentLoaded", () => {
  const q9Checkboxes = document.querySelectorAll('input[name="site_result[]"]');
  if (q9Checkboxes.length === 0) return;

  const notApplicable = Array.from(q9Checkboxes).find(
    cb => (cb.value || "").toLowerCase().includes("not applicable")
  );
  const others = Array.from(q9Checkboxes).filter(cb => cb !== notApplicable);

  if (!notApplicable) return;

  // Initial state check
  if (notApplicable.checked) {
    others.forEach(cb => {
      cb.checked = false;
      cb.disabled = true;
      cb.closest("label")?.classList.add("disabled");
    });
  }

  // When Not Applicable is toggled
  notApplicable.addEventListener("change", () => {
    if (notApplicable.checked) {
      others.forEach(cb => {
        cb.checked = false;
        cb.disabled = true;
        cb.closest("label")?.classList.add("disabled");
      });
    } else {
      others.forEach(cb => {
        cb.disabled = false;
        cb.closest("label")?.classList.remove("disabled");
      });
    }
  });

  // If others are checked, uncheck Not Applicable
  others.forEach(cb => {
    cb.addEventListener("change", () => {
      if (cb.checked) {
        notApplicable.checked = false;
        notApplicable.disabled = false;
        notApplicable.closest("label")?.classList.remove("disabled");
      }
    });
  });
});

</script>

</body>
</html>